# SetDeviceSettings Method - intrepidcs API

This method writes configuration settings to various devices.

{% tabs %}
{% tab title="C/C++ Declare" %}
```cpp
int _stdcall icsneoSetDeviceSettings(void * hObject, SDeviceSettings *pSettings, int iNumBytes, int bSaveToEEPROM, int VnetChan);
```
{% endtab %}

{% tab title="Visual Basic .NET Declare" %}
```vbnet
Public Declare Function icsneoSetDeviceSettings”icsneo40.dll” (ByVal hObject As IntPtr, ByRef pSettings As SDeviceSettings , ByVal iNumBytes As Int32, ByVal bSaveToEEPROM As Int32, ByVal VnetChan As Int32) As Int32
```
{% endtab %}

{% tab title="C# Declare" %}
```csharp
[DllImport(“icsneo40.dll”)] public static extern Int32 icsneoSetDeviceSettings(IntPtr hObject, rref SDeviceSettings pSettings, Int32 iNumBytes, Int32 bSaveToEEPROM, Int32 VnetChan);
```
{% endtab %}
{% endtabs %}

**Parameters**

hObject

\[in] Specifies the driver object created by [OpenNeoDevice](../../basic-functions-overview-intrepidcs-api/openneodevice-method-intrepidcs-api.md).

pSettings

\[in] The address of an allocated [SDeviceSettings](../../structures-types-and-defines-overview-intrepidcs-api/setting-structures-overview-intrepidcs-api/sdevicesettings-structure.md) structure.

iNumBytes

\[in] This value is always the size, in bytes, of the [SDeviceSettings](../../structures-types-and-defines-overview-intrepidcs-api/setting-structures-overview-intrepidcs-api/sdevicesettings-structure.md) structure.

bSaveToEEPROM

\[in] If set to 0, the settings changes will revert to the values stored in EEPROM when the neoVI FIRE 2 is power-cycled. If set to 1, the values will overwrite the EEPROM settings and become persistent across power-cycles of the neoVI FIRE 2.

VnetChan

\[in] This value is indicates which Vnet to set the settings to. This parameter is intended for neoVI ION and neoVI Plasma which have more than one Vnet Slot. For all other devices set this to 0.

**Return Values**

Returns 1 if successful, 0 if an error occurred. [GetLastAPIError](../../error-functions-overview-intrepidcs-api/getlastapierror-method-intrepidcs-api.md) must be called to obtain the specific error. The errors that can be generated by this function are:

NEOVI\_ERROR\_DLL\_NEOVI\_NO\_RESPONSE = 75

**Remarks**

Before using this function, the [SDeviceSettings](../../structures-types-and-defines-overview-intrepidcs-api/setting-structures-overview-intrepidcs-api/sdevicesettings-structure.md) structure must be initialized with the current neoVI settings using [GetDeviceSettings](getdevicesettings-method-intrepidcs-api.md).

### Examples

{% tabs %}
{% tab title="C/C++ Example" %}
```cpp
SDeviceSettings DeviceReadSettings;
int iNumberOfBytes;
int iResult;

//################################
//Read Settings struct first
//and changed as needed before
//Setting the new values
//################################

iNumberOfBytes=sizeof(DeviceReadSettings);
iResult = icsneoSetDeviceSettings(m_hObject, &DeviceReadSettings, iNumberOfBytes, 1, 0);
if(iResult == 0)
{
    MessageBox::Show("Problem Sending Device configuration");
    return;
}
```
{% endtab %}

{% tab title="C# Example" %}
```csharp
SDeviceSettings DeviceReadSettings = new SDeviceSettings
int iNumberOfBytes;
int iResult;

//################################
//Read Settings struct first
//and changed as needed before
//Setting the new values
//################################

iNumberOfBytes = System.Runtime.InteropServices.Marshal.SizeOf(DeviceReadSettings);
DeviceReadSettings.uiDevice = EDeviceSettingsType.DeviceFireSettingsType;
iResult = icsNeoDll.icsneoSetDeviceSettings(m_hObject, ref DevoceReadSettings, iNumberOfBytes, 1, 0);

if(iResult == 0)
{
    MessageBox.Show("Problem Sending Device configuration");
    return;
}
```
{% endtab %}

{% tab title="Visual Basic .NET Example" %}
```vbnet
Dim DeviceReadSettings As SDeviceSettings
Dim iNumberOfBytes As Integer
Dim iResult As Integer

'//################################
'//Read Settings struct first
'//and changed as needed before
'//Setting the new values
'//################################

iNumberOfBytes = System.Runtime.InteropServices.Marshal.SizeOf(DeviceReadSettings)
DeviceReadSettings.uiDevice = EDeviceSettingsType.DeviceFireSettingsType
iResult = icsneoSetDeviceSettings(m_hObject, DeviceReadSettings , iNumberOfBytes, 1, 0)

If iResult = 0 Then
    MsgBox("Problem Sending Device configuration")
    Exit Sub
End If
```
{% endtab %}
{% endtabs %}
